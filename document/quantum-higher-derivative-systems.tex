In this section the quantum counterpart of the previous classical system will be
studied. In the following the process of \emph{canonical quantization} is used
to go from the classical world to the quantum one and a brief summary is given
in the Appendix~\ref{appendix:canonical_quantization}. This procedures will be
used to derive the Quantum Pais-Uhlenbeck (QPU) oscillator starting
from~\eqref{eq:lagrangian_PU}. The quantum version of the Ostrogradsky theorem
will be proved and lastly more examples of ghost-ridden theories are given.

\subsection{Ghosts}\label{section:ghosts}
As said previously in Section~\ref{subsection:
linear_ostrogradskian_instability}, in quantum mechanics \emph{linear
Ostrogradskian instability} goes under the name ``\emph{ghost}''. Just like
classical HD theories, quantum HD theories have the spectrum of the Hamiltonian
unbounded. Theorem~\ref{th:ostrogradsky_classical} has its quantum counterpart:

\begin{theorem}\label{th:ostrogradsky_quantum}~\cite{Smilga17}
  The quantum counterpart of Hamiltonian~\eqref{eq:general_hamiltonian_1dim}
  for a non-degenerate higher-derivative system has no ground state.
\end{theorem}
\begin{proof}
  The proof is given for a one-dimensional system ($\mu=1$) describe by a second
  order Lagrangian ($n=2$); the generalization for a multi-dimensional HD system
  is straightforward. The result Hamiltonian is
  \begin{equation*}
    H = h(Q_1, Q_2, P_2) P_2 + Q_2 P_1 - L(Q_1, Q_2, h)
  \end{equation*}
  Using the canonical quantization the function H is converted to a quantum
  observable $\hat{H}$ which eigenvalue are the allowed energies of the system.
  \begin{align*}
    & \begin{cases}
      Q_1 \xrightarrow{\wedge} \hat{Q_1} \equiv \hat{x}
      \quad &\mid \quad \hat{x}\psi(x, v) = x \psi(x, v) \\
      P_1 \xrightarrow{\wedge} \hat{P_1} \equiv \hat{p}_x
      \quad &\mid \quad \hat{p}_x\psi(x, v) = -i\partial_x \psi(x, v) \\
    \end{cases} \\
    & \begin{cases}
      Q_2 \xrightarrow{\wedge} \hat{Q_2} \equiv \hat{v}
      \quad &\mid \quad \hat{v}\psi(x, v) = v \psi(x, v) \\
      P_2 \xrightarrow{\wedge} \hat{P_2} \equiv \hat{p}_v
      \quad &\mid \quad \hat{p}_v\psi(x, v) = -i\partial_v \psi(x, v) \\
    \end{cases}
  \end{align*}
  \begin{equation} \label{eq:ham_operator_2nd_order}
    \hat{H} = h(\hat{x}, \hat{v}, \hat{p}_v) \hat{p}_v + \hat{v} \hat{p}_x -
    L (\hat{x}, \hat{v}, h)
  \end{equation}

  Moreover suppose that the spectrum of the Hamiltonian is discrete. If it were
  continuous, we can put the system in a box so the range of $x$ and $v$ is
  finite which makes the spectrum discrete. At the end we can remove the
  regularization by sending the box size to infinity. Let $\psi_0(x, v)$ be the
  normalized ground state of the system with the associated eigenvalue $E_0$,
  i.e. $\hat{H}\psi_0(x, v) = E_0 \psi_0(x, v)$. To seek for an energy value
  close to $E_0$ we use the \emph{variational method}~\footnote{
    Variational methods must not be confused with variational calculus, they are
    totally different things.
  } with the following variational ansatz:
  \begin{equation}
    \psi_c(x, v) = e^{icx}\psi_0(x,v)
  \end{equation}

  A generic linear combination of state $\psi_c$ is
  \begin{equation}
    \psi_f = \int f(c) \psi_c \, dc = \psi_0 \int f(c) e^{icx} \, dc =
    \psi_0 \tilde{f}(x)
  \end{equation}
  where $\tilde{f}(x)$ is the Fourier transform of $f(c)$.

  Notice that neither $\psi_c$ nor $\psi_f$ are eigenfunction of the
  Hamiltonian~\eqref{eq:ham_operator_2nd_order}
  \begin{align*}
    &\hat{H} \psi_c(x,v) = E_0\psi_c(x, v) + cv \psi_c(x,v)
    \neq \lambda \psi_c(x,v) \\
    &\hat{H} \psi_f(x,v) = E_0\psi_f(x, v) -
    iv \frac{\partial \tilde{f}(x)}{\partial x} \psi_c(x,v)
    \neq \lambda \psi_c(x,v)
  \end{align*}

  Since $\psi_c$ and $\psi_f$ do not vanish their expectation value
  must not be lower than $E_0$ and can be obtain by direct calculation.

  \begin{equation*}
    E_0 \leq E_c = \int \psi_c^* \hat{H} \psi_c \, dx \, dv =
    E_0 + c \int v \left|\psi_0 \right| ^2 \, dx \, dv
  \end{equation*}

  If the integral $\int v \left|\psi_0 \right| ^2 \, dx \, dv$ does not vanish
  then arbitrarily negative energies can be reach by an appropriate choice of $c$.
  Otherwise if the integral vanish, $E_c$ does not depend on $c$ and does not
  grow. Thus, the system does not have a non-degenerate ground state. \\
\end{proof}


\subsection{Quantum Pais-Uhlenbeck oscillator}
The first study to be publish about a quantum HD theory was the \emph{Quantum
Pais-Uhlenbeck oscillator} (QPU)~\cite{PU50}. In order to obtain the Hamiltonian
(operator) $\hat{H}_{QPU}$ of the QPU system,
the $L_{PU}$~\eqref{eq:lagrangian_PU} had to be converted in the corresponding
Hamiltonian $H_{PU}$ and then canonically quantize it, i.e.
$L_{PU} \rightarrow H_{PU} \xrightarrow{\wedge} \hat{H}_{QPU}$
\footnote{
  Notation for quantum operators is
  the same used in the proof of Theorem~\ref{th:ostrogradsky_quantum}
}.

\begin{equation} \label{eq:hamiltonian_QPU}
  \hat{H}_{QPU} = \hat{p}_x \hat{v} + \frac{\hat{p}_v^2}{2}
  + \left(\omega_1^2 + \omega_2^2\right)\frac{\hat{v}^2}{2}
  - \omega_1^2\omega_2^2 \frac{\hat{x}^2}{2}
\end{equation}

\subsubsection{Non-degenerate frequencies: $\omega_1 \neq \omega_2$}

Consider the following canonical transformation and then canonically quantize
the new canonical variables $\tilde{Q}$ and $\tilde{P}$
\footnote{
  The proposed transformation is canonical because the canonical commutation
  relations are still valid, i.e.
  $\left\{ \tilde{Q_i} \, , \, \tilde{Q_j}\right\} =
  \left\{ \tilde{P_i} \, , \, \tilde{P_j}\right\} = 0$ and
  $\left\{ \tilde{Q_i} \, , \, \tilde{P_j}\right\} = \delta_{ij}$
}~\cite{Mannheim05}.

\begin{align*}
  \tilde{Q_1} &= \frac{1}{\omega_1}
    \frac{P_1 \, + \,  \omega_1^2 Q_2} {\sqrt{\omega_1^2-\omega_2^2}}
              &\xrightarrow{\wedge}& &\hat{\tilde{Q}}_1 \equiv
  \hat{X}_1 &= \frac{1}{\omega_1}
    \frac{\hat{p}_x \, + \,  \omega_1^2 v} {\sqrt{\omega_1^2-\omega_2^2}}
    \\
  \tilde{P_1} &= \omega_1
    \frac{P_2 \, + \, \omega_2^2 Q_1} {\sqrt{\omega_1^2-\omega_2^2}}
              &\xrightarrow{\wedge}& &\hat{\tilde{P}}_1 \equiv
    \hat{P}_1 &= \omega_1
    \frac{\hat{p}_v \, + \,  \omega_2^2 x} {\sqrt{\omega_1^2-\omega_2^2}}
    \\
  \tilde{Q_2} &=
    \frac{P_2 \, + \,  \omega_1^2 Q_1} {\sqrt{\omega_1^2-\omega_2^2}}
              &\xrightarrow{\wedge}& &\hat{\tilde{Q}}_2 \equiv
  \hat{X}_2 &=
    \frac{\hat{p}_v \, + \,  \omega_1^2 x} {\sqrt{\omega_1^2-\omega_2^2}}
    \\
  \tilde{P_2} &=
    \frac{P_1 \, + \, \omega_2^2 Q_2} {\sqrt{\omega_1^2-\omega_2^2}}
              &\xrightarrow{\wedge}& &\hat{\tilde{P}}_2 \equiv
  \hat{P}_2 &=
    \frac{\hat{p}_x \, + \,  \omega_2^2 v} {\sqrt{\omega_1^2-\omega_2^2}}
\end{align*}

Using $\hat{X}$ and $\hat{P}$, the Hamiltonian~\eqref{eq:hamiltonian_QPU}
becomes the difference of two independent quantum harmonic oscillators.

\begin{equation} \label{eq:Ham-QPU-HO}
  \hat{H} =
  \frac{\hat{P}_1^2 \, + \, \omega_1^2 \hat{X}_1^2}{2} -
  \frac{\hat{P}_2^2 \, + \, \omega_2^2 \hat{X}_2^2}{2} \equiv
  \hat{H}_1 - \hat{H}_2
\end{equation}

The spectrum of $\hat{H}$ follows from the solution of the equation
$\hat{H} \psi = E \psi$. Let $\psi$ be the product of the eigenstates of two
independent simple one-dimensional quantum harmonic oscillator $\psi_n$ and
$\psi_m$, i.e.

\begin{equation*}
  \psi(X_1, X_2) = \psi_n(X_1) \psi_m(X_2)
  \quad \text{where} \quad
  \begin{cases}
    &\hat{H}_1\psi_n = \omega_1 \left( \frac{1}{2} + n \right)\psi_n \\
    &\hat{H}_2\psi_m = \omega_2 \left( \frac{1}{2} + m \right)\psi_m
  \end{cases}
\end{equation*}

\begin{align*}
  \hat{H} \psi
  &= \left(\hat{H}_1 - \hat{H}_2\right) \left(\psi_n \psi_m\right) \\
  &= \left(\hat{H}_1\psi_n\right)\psi_m - \left(\hat{H}_2\psi_m\right)\psi_n \\
  &= \left(
    \omega_1\left(\frac{1}{2} + n\right) -
    \omega_2\left(\frac{1}{2} + m\right)
     \right) \left(\psi_n\psi_m\right)
\end{align*}



So the spectrum is

\begin{equation}
  E_{mn} =
  \omega_1 \left( \frac{1}{2} + n \right) -
  \omega_2 \left( \frac{1}{2} + m \right)
  \qquad m,n = 0,1,2,\ldots
\end{equation}

Consider the situation where ratio between $\omega_2$ and $\omega_1$ is a
rational number $k$; the spectrum can be written as

\begin{equation*}
  E_{mn} = \omega_1 \left( \frac{1-k}{2} + n + mk \right)
\end{equation*}
so the spectrum is discrete. On the other hand if the frequencies are
incommensurable the every real number can be hit by an appropriate choice of
$n$ and $m$. But the wave function of all eigenstate are normalizable, so the
spectrum is not continuous but rather pure point. \\

In theoretical physics, \emph{ghosts} are quantum states with negatives norms.
Negative norm means ``negative probability'' which does not make sense, so
these states does not have a physical meaning. Nevertheless they appear in a
well established theories (e.g. QED) during the quantization procedure and in
such contests they turn out to be harmless~\cite{Smilga01}.

Ghosts appear in the quantum Pais-Uhlenbeck oscillator when we try to get rid
of negatives energies (i.e.\ make the energy spectrum bounded from below).
First we define the usual creation and annihilation operators for the
quantum harmonic oscillators
\begin{equation} \label{eq:a_operators}
  \hat{a}_j := \frac{1}{\sqrt{2\omega_j}}
    \left(\partial_{X_j} + \omega_j X_j\right) \quad
  \hat{a}_j^{\dagger} := \frac{1}{\sqrt{2\omega_j}}
    \left(-\partial_{X_j} + \omega_j X_j\right)
\end{equation}
where their commutator is
\begin{equation} \label{eq:a_commutator}
  \left[ \hat{a}_j, \hat{a}_j^{\dagger} \right] =
  \hat{a}_j \ \hat{a}_j^{\dagger} - \hat{a}_j^{\dagger} \ \hat{a}_j = 1
\end{equation}

Using~\eqref{eq:a_operators} can rewrite the Hamiltonian~\eqref{eq:Ham-QPU-HO} as
\begin{align} \label{eq:Ham_a_operators}
  \hat{H} &=
    \omega_1 \left( \hat{a}_1 \hat{a}_1^{\dagger} - \frac{1}{2} \right) -
    \omega_2 \left( \hat{a}_2 \hat{a}_2^{\dagger} - \frac{1}{2} \right) \notag
    \\    &=
    \omega_1 \hat{a}_1 \hat{a}_1^{\dagger} -
    \omega_2 \hat{a}_2 \hat{a}_2^{\dagger} +
    \frac{\omega_2 - \omega_1}{2}
\end{align}

Notice that the second term in~\eqref{eq:Ham_a_operators} produces exited states
with decreasing negatives energies. We can stop this behavior by \emph{formally}
defining a state $\phi(X_2)$ such that
\begin{equation*}
  \hat{a}_2^{\dagger} \ \phi(X_2) = 0
\end{equation*}

The wave function of such state is~\cite{Ilhan13}
\begin{equation*}
  \phi(X_2) \propto \exp \left\{ \frac{\omega_2}{2} X_2^2\right\}
\end{equation*}
indeed
\begin{align*}
  \hat{a}_2^{\dagger} \ \phi(X_2)
  &= \frac{1}{\sqrt{2\omega_2}}
    \left(-\partial_{X_2} + \omega_2 X_2\right)
    \exp \left\{ \frac{\omega_2}{2} X_2^2\right\} \\
  &= \frac{1}{\sqrt{2\omega_2}}
    \left(-\frac{\omega_2}{2} \, 2 \, X_2 + \omega_2 X_2\right)
    \exp \left\{ \frac{\omega_2}{2} X_2^2\right\}
  = 0
\end{align*}

The $\phi$ state has positive norm and have the lowest energy by definition.
The operator $\hat{a}_2$ acts on it as creation operator while
$\hat{a}_2^{\dagger}$ acts on it as annihilation operator (this behavior it's
the opposite of the usual one). The consequences of defining such state $\phi$
is that \emph{exited states of $\phi$ have negatives norms (i.e.\ are ghosts)}.
Starting from $\phi$ we can obtain exited states with the action of the creation
operator $\hat{a}_2$
\begin{equation*}
  {\Big| \hat{a}_2 \ket{\phi} \Big|}^2 =
  \bra{\phi} \hat{a}_2^{\dagger} \hat{a}_2 \ket{\phi} =
  \underbrace{
    \bra{\phi} \hat{a}_2 \hat{a}_2^{\dagger} \ket{\phi}
  }_{0} - \bra{\phi} \ket{\phi} < 0
\end{equation*}
where in the last steps was used equation~\eqref{eq:a_commutator}
Negative norm entails a violation of unitary which
leads to the wrong conclusion that every HD-theory is intrinsically sick.

\subsubsection{Degenerate frequencies: $\omega_1 = \omega_2$}
If frequencies $\omega_1$ and $\omega_2$ are the same, the previous
transformation can not be performed due to the vanishing denominator.
Nevertheless a solution can be obtain following the procedure described
in~\cite{PU50, Bolonek06}. Let $\psi$ be written as

\begin{equation*}
  \psi(x, v) = e^{-i\omega^2xv}\phi(x,v)
\end{equation*}

So $\hat{H}$ acts on such $\psi$ as

\begin{equation*}
  \hat{H} \psi = e^{-i\omega^2xv}
  \left[\frac{\hat{p}_v^2}{2} + v\hat{p}_x - \omega^2x\hat{p}_v \right] \phi
  \quad \Rightarrow \quad
  \hat{H}_{\phi} :=
  \frac{\hat{p}_v^2}{2} + v\hat{p}_x - \omega^2x\hat{p}_v
\end{equation*}

Now, on $\hat{H}_{\phi}$ we can apply a scale transformation and then a unitary
transformation\footnote{
  During the calculation of $\hat{H}'_{\phi}$ was useful swapping
  two non-commuting operators (e.g. $v$ and $e^{\lambda \hat{p}_v}$)
  so that their commutator appears. This identity was used:
  $\left[e^{\lambda \, \hat{A}}, \, \hat{B}\right] =
  \lambda \, e^{\lambda \, \hat{A}} \left[\hat{A} , \, \hat{B} \right]$
}.

\begin{equation*}
  \text{scale} \
  \begin{cases}
    &x         \rightarrow x/\omega \\
    &\hat{p}_x \rightarrow \omega\hat{p}_x
  \end{cases}
  \qquad \text{unitary} \;
  \U = \exp\left\{ - \frac{\hat{p}_x \hat{p}_v}{4}\right\}
\end{equation*}
to get

\begin{equation*}
  \hat{H}'_{\phi} = \, \U^{\dagger}
  \hat{H}_{\phi} \left(x/\omega,\ v,\ \omega \hat{p}_x,\ \hat{p}_v\right) \ \U
  \quad \text{with} \quad
  \phi'(x, v) = \U \phi\left(x/\omega, v\right)
\end{equation*}
so that

\begin{equation} \label{eq:ham_phi_PU}
  \hat{H}'_{\phi} = \frac{\hat{p}^2_x \, + \, \hat{p}^2_{v}}{4}
  + \omega \left(v \hat{p}_x - x \hat{p}_v \right)
\end{equation}

Hamiltonian~\eqref{eq:ham_phi_PU} can be interpreted as the Hamiltonian of a
free particle plus the term $\omega \left(v \hat{p}_x - x \hat{p}_v \right)$
which resemble the orbital angular momentum in the $(\omega x, \, v)$ plane.
Going in polar coordinates and reverting back to the original $\psi$, we obtain

\begin{align} \label{eq:sol_ham_degen_PU}
  \psi_{l, \, k}(x, v \,; t) \ &\propto \
  e^{-i\omega^2xv}
  \exp\left\{
    \frac{i}{4\omega^2} \frac{\partial^2}{\partial x \partial v}
  \right\} \cdot \nonumber \\
  &\cdot \left[
    J_l \left(k\sqrt{v^2 + \omega^2 x^2}\right)
    {\left( \frac{wx - iv}{wx +iv} \right)}^{l/2}
  \right]
  e^{-it (l\omega + k^2/4)}
\end{align}

Wave functions~\eqref{eq:sol_ham_degen_PU} are not normalizable hence the
spectrum is continuous. Moreover each energy level is infinitely degenerate:
$\psi_{l+1, \, k}$ and $\psi_{l, \, \sqrt{k^2 + 4 \omega}}$ have same
eigenvalue.
