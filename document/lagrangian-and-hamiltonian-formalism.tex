Before diving into the study of Higher Derivative (HD) systems, i.e.\
systems characterized by Lagrangian contains terms such as $\ddot{q}$,
${q}^{(3)}$, \dots, it's better to review some basic concepts of the
\emph{Lagrangian} and \emph{Hamiltonian formalism} in order to fix ideas and
notations.

\subsection{Lagrangian formalism}\label{subsection: lagrangian_formalism}
When talking about \emph{Lagrangian formalism} we mean the whole mathematical
formalism that it has been develop around the \emph{Lagrangian mechanics} and then
extended way beyond the realm of classical mechanics. The Lagrangian mechanics
was born as an alternative formulation of the \emph{Newtonian mechanics}
describing a system analytically
%TODO
%No figures will be found in this work. The methods I present require neither
%constructions nor geometrical or mechanical arguments, but solely algebraic
%operations subject to a regular and uniform procedure.
%Lagrange (MeÃÅcanique analytique - preface to the First Edition)
instead of the vector based approach used by
Newton. The keys concepts of Lagrangian mechanics are: \emph{generalized
coordinates}, \emph{degrees of freedom} and \emph{constraints}.

\begin{definition}\label{def: generalized coordinates}~\cite{Ginsberg08}
  \emph{Generalized coordinates} $q^{\mu}$ are a set of coordinates (i.e.\ a
  collection of real number) that describe uniquely the configuration of a
  system.
\end{definition}

\begin{definition}\label{def: dof}~\cite{Ginsberg08}
  The minimum number $n$ of generalized coordinates required to specify the
  position of a system is the \emph{number of degrees of freedom} of that
  system.
  %TODO "They may be locally dependent"
\end{definition}

\begin{definition}\label{def: holonomic constraints}~\cite{
  Goldstein11_hol_constraints}
  \emph{Holonomic constraints} are relation between generalized coordinates
  which can be expressed as:
  \begin{equation*}
      f(q^{\mu}) = 0 \qquad \mu = 1, \ldots, n
  \end{equation*}
\end{definition}

Once generalized coordinates has been chosen their evolution describe the
evolution of the system. According to classical mechanics $q^{\mu}$ evolve
in a smooth fashion following the \emph{equation of motion}. This
``smoothness'' allows following definition:

\begin{definition}
  The \emph{generalized velocities} $\dot{q}^{\mu}$ are the time derivatives of
  the generalized coordinates $q^{\mu}$, i.e.
  \begin{equation*}
    \dot{q}^{\mu} := \frac{dq^{\mu}(t)}{dt}
  \end{equation*}
  The same idea can used to define
  \begin{equation*}
    \ddot{q}^{\mu} := \frac{d^2 q^{\mu}(t)}{dt^2} \qquad \ldots \qquad
        q^{(n)\mu} := \frac{d^n q^{\mu}(t)}{dt^n}
  \end{equation*}
\end{definition}

Sometimes to lighten the notation $q^{(n)\mu}$ will be denoted by
$\bm{q}^{(n)}$ but should not be mistaken by a vector: there is no something
like a basis where $q^{\mu}$ play the role of the components. \\

In Newtonian mechanics the equations of motion are ordinary second order
differential equation related the position vector $\vec{x}$ and the forces
$\vec{F}$:

\begin{equation*}
  m \frac{d^2\vec{x}}{dt^2} = \vec{F}
\end{equation*}

Lagrangian mechanics do not start from equations of motion for the description
of the system; instead it's defined a function called the \emph{Lagrangian}:

\begin{equation} \label{eq:general_lagrangian}
  L(\bm{q}, \dot{\bm{q}}, \ddot{\bm{q}}, \ldots, \bm{q}^{(n)})
\end{equation}

An \emph{action functional} $S[q^{\mu}]$ can be associated to a system described
by the Lagrangian $L$ evolving from time $t_1$ to time $t_2$

\begin{equation} \label{eq:general_action}
  S[q^{\mu}] := \int_{t_1}^{t_2} dt
  L(\bm{q}, \dot{\bm{q}}, \ddot{\bm{q}}, \ldots, \bm{q}^{(n)})
\end{equation}

The last ingredient to finally derive the equation of motion in the Lagrangian
formalism is the \emph{Hamilton's principle}~\cite{Goldstein11_Ham_principle}:
\begin{displayquote}
  \emph{The motion of the system it's a stationary point of the action
  functional~\eqref{eq:general_action}}, i.e.
  \begin{equation*}
    \frac{\delta S[\bm{q}]}{\delta \bm{q}} = 0
  \end{equation*}
\end{displayquote}
Keeping ``fixed-end'' during the variation (the initial and final configurations
of the system are the ones we choose hence are fixed) and using the results from
Appendix~\ref{appendix: calculus of variation} we arrive at the
\emph{Euler-Lagrange equation}, i.e.\ the equation of motion in Lagrangian
mechanics.

\begin{equation} \label{eq:euler-lagrange}
  \frac{\delta S[\bm{q}]}{\delta \bm{q}} =
  \frac{\partial L}{\partial \bm{q}} -
  \frac{d}{dt}\frac{\partial L}{\partial \dot{\bm{q}}} +
  \frac{d^2}{dt^2}\frac{\partial L}{\partial \ddot{\bm{q}}} -
  \ldots = 0
\end{equation}

Usually the underling Lagrangian of a classical mechanical system is $L(q^{\mu},
\dot{q}^{\mu})$ so the equation~\eqref{eq:euler-lagrange} it's truncated after
the second term. In this special case the Lagrangian mechanics and Newtonian
mechanics are equivalent. Usually $L$ can be written as difference of two
quantities of the Newtonian mechanics: kinetic energy $T$ and potential energy
$V$. \\

In the classical mechanics problems (such as a particle constrained on a surface
or a double pendulum) the number of degrees of freedom of the system is finite.
Lagrangian formalism can be extends to systems with an infinite countable number
of degrees of freedom. But the formalism could be push further and be able to
describe \emph{classical fields}.

%TODO "Data (f) con 0 <= x < 2pi posso  fare Fourier ossia f(x) ~ {fn}"
\begin{definition}\label{def: classical field}~\cite{
  Aldrovandi19_classical_field}
  A \emph{classical field} is a system with a continuous infinity of degrees of
  freedom.
\end{definition}

Going from discrete to continuous the notation to indicate the generalized
coordinates has to be review

\begin{align*}
  q(t) \rightarrow \phi, \quad \mu \rightarrow \vec{x}
  \qquad \Rightarrow \qquad
  q^{\mu}(t) \rightarrow \phi(\vec{x},t)
\end{align*}

The previous generalized coordinates $q$ were just $\mu$ real number evolving in
time according to~\eqref{eq:euler-lagrange}. Now $\phi$ are the generalized
coordinates but unlike $q$ they are function of space $\vec{x}$ and time $t$.
The evolution of $\phi$ depends on time and space so the dot notation for the
derivation should be replace by a one that take also space derivatives
into account. Special relativity provide a nice framework to join the space and
time into \emph{spacetime} that allows us to treat $\vec{x}$ and $t$ on equal
footing
\footnote{
  Following the standard notation quantities derived from Newtonian space are
  written with arrow (e.g. $\vec{x}$, $\vec{p}$) while the corresponding
  quantities in Minkowski spacetime are not (e.g. $x$, $p$).
}.

\begin{equation*}
  x^0 := ct \qquad
  x := (x^0, \vec{x}) \qquad
  \partial_{\mu} := \left(
    \frac{\partial}{\partial x^0},
    \frac{\partial}{\partial x^1},
    \frac{\partial}{\partial x^2},
    \frac{\partial}{\partial x^3}
  \right)
\end{equation*}

The Lagrangian can also express the interaction between two or more fields.
Given a set of fields $\bm{\phi}(x):=\{\phi_i(x)\}$ with $i=1,\ldots,n$ the
Lagrangian will have the form

\begin{equation} \label{eq:general_lagrangian_density}
  \Lagr(x) = \Lagr[
      \bm{\phi}(x),
      \partial_{\mu} \bm{\phi}(x),
      \partial_{\mu} \partial_{\nu} \bm{\phi}(x),
      \ldots
    ]
\end{equation}

Comparing~\eqref{eq:general_lagrangian}
and~\eqref{eq:general_lagrangian_density} it's clear that they are two different
mathematical object. The input to the
Lagrangian~\eqref{eq:general_lagrangian_density} are the functions
$\bm{\phi}(x)$ so $\Lagr(x)$ is not a function but a functional. The proper name
of this object is \emph{Lagrangian density}

% no need to include
% \footnote{The origin of the term \emph{density} came from differential geometry.
%   \emph{1-weight tensor densities} are object that transforms almost like
%   tensor but producing and extra multiplicative factor: the inverse determinant
%   of the transformation. Later when evaluating the action~\eqref{
%   eq:general_action_fields}, under a change of coordinates, this term
%   cancel out with the determinant produced by $dx$.
% }.

In order to obtain the equations that describe the spacetime evolution of the
fields, the so called \emph{fields equations}, we apply Hamilton's principle
to~\eqref{eq:general_lagrangian_density}

\begin{equation} \label{eq:general_action_fields}
  S[\bm{\phi}] := \int d^4x \Lagr(x)
\end{equation}

Observe that integration run over $x$, so $S[\bm{\phi}]$ depends only on the
functional form of $\phi$. Using again the concept of functional derivative
(Appendix~\ref{appendix: calculus of variation}) we
get~\eqref{eq:euler-lagrange-field}. Formally the steps are equal to the
derivation of~\eqref{eq:euler-lagrange}, but instead to take the derivative with
respect to time, the $\partial_{\mu}$ has been used.

\begin{equation} \label{eq:euler-lagrange-field}
  \frac{\delta S[\bm{\phi}]}{\delta \bm{\phi}} =
    \frac{\partial \Lagr}{\partial \bm{\phi}} -
    \partial_{\mu} \frac{\partial \Lagr}{\partial \partial_{\mu}\bm{\phi}} +
    \partial_{\mu}\partial_{\nu}\frac{\partial L}
    {\partial \partial_{\mu}\partial_{\nu}\bm{\phi}} -
    \ldots = 0
\end{equation}

One of the important aspect that link Lagrangian (density) and motion (field)
equation are the \emph{symmetries}: every symmetries of the Lagrangian is also a
symmetry of the equation of motion~\cite{Aldrovandi19_symmetry}. In the past,
scientists try to directly wrote down the equations that govern motion of
classical objects after observing their behavior. So the formulation of physical
theories stops at what humans can experience. On the other hand in the
Lagrangian formalism one try an educated guess of the Lagrangian based on the
symmetries observed and then derive the equation of motion that will be tested
by experiments.


\subsection{Hamiltonian formalism}\label{subsection: hamiltonian_formalism}
\emph{Hamiltonian formalism} it's the mathematical framework underling
\emph{Hamiltonian mechanics} which is again a reformulation of Newtonian
mechanics based on the Lagrangian mechanics. The connection between these two
formalism can be made mathematically rigorous using the so called \emph{Legendre
map} that moves objects from ``Lagrange-world'' (the tangent bundle of
configuration manifold) to ``Hamilton-world'' (the cotangent bundle of
configuration manifold). This derivation is not discuss here and we just
provide the recipe for constructing Hamiltonian formalism starting from the
Lagrangian one.

\begin{enumerate}
  \item Let $L(\bm{q}, \dot{\bm{q}}, \ldots, \bm{q}^{(n)})$ be the Lagrangian
    for a system, define \emph{conjugate momenta} and pair them with the
    corresponding \emph{generalized coordinates}
    \begin{equation} \label{eq:def_canonical_coordinates}
      Q_{(i)}^{\mu} := q^{(i-1)\mu}
      \quad \leftrightarrow \quad
      P_{(i)\mu} := \frac{\delta L}{\delta q^{(i)\mu}}
      \qquad i = 1, \ldots, n
    \end{equation}
    These are called the \emph{i-th canonical coordinates}
    $(Q_{(i)}^{\mu}, \, P_{(i)\mu}) \equiv
    (\bm{Q}_{i}, \, \bm{P}_{i})$\footnote{
      This choice of canonical coordinates is due to Ostrogradsky and is used
      in~\cite{Smilga17, Chen13}.
    }.

  \item Define the function $\tilde{H}$ as
    \begin{equation} \label{eq:Ham_in_q}
      \tilde{H}(\bm{q}, \dot{\bm{q}}, \ldots, \bm{q}^{(n)}) :=
      \sum_{i=1}^{n} \frac{\delta L}{\delta \bm{q}^{(i)}} \bm{q}^{(i)} -
      L(\bm{q}, \dot{\bm{q}}, \ldots, \bm{q}^{(n)})
    \end{equation}
    Under the hypothesis of \emph{regular Lagrangian}, $\bm{q}^{(n)}$ can be
    recover from the definition of $\bm{P}_n$ inverting equation
    \begin{equation} \label{eq:qn=h}
      \frac{\delta L}{\delta \bm{q}^{(n)}} = \bm{P}_i
      \quad \Rightarrow \quad
      \bm{q}^{(n)} \equiv q^{(n)\mu} =
      h^{\mu}(Q^{\mu}_{(1)}, \ldots, Q^{\mu}_{(n)}, P_{(n)\mu}) \equiv \bm{h}
    \end{equation}
    Substituting~\eqref{eq:def_canonical_coordinates} and~\eqref{eq:qn=h}
    in~\eqref{eq:Ham_in_q}, the \emph{Hamiltonian} is obtain
    \begin{equation} \label{eq:general_hamiltonian}
      H = \bm{P}_n \bm{h} + \bm{P}_{n-1} \bm{Q}_n + \cdots + \bm{P}_1 \bm{Q}_2
          - L(\bm{Q}_1, \bm{Q}_2, \ldots, \bm{h})
    \end{equation}

  \item The Hamiltonian generate the time evolution of any function of canonical
    variables $F(\bm{Q}_i, \bm{P}_i)$ via the
    \emph{Poisson Bracket}~\cite{Chen13}:
    \begin{equation} \label{eq:poisson_bracket_evolution}
      \dot{F}(\bm{Q}_i, \bm{P}_i) = \left\{
        F(\bm{Q}_i, \bm{P}_i), H
      \right\}
    \end{equation}

    Poisson Bracket, in canonical coordinates, are defined as
    \begin{equation*} \label{eq:possion_braket}
      \left\{ f, g \right\} := \sum_{i=1}^{n} \left(
        \frac{\partial f}{\partial Q^{\mu}_{(i)}}
        \frac{\partial g}{\partial P_{\mu(i)}} -
        \frac{\partial f}{\partial P_{\mu(i)}}
        \frac{\partial g}{\partial Q^{\mu}_{(i)}}
      \right)
    \end{equation*}
    In particular they can be used for deduce the evolution of the i-th
    canonical coordinates:
    \begin{align*}
      \left\{ Q^{\mu}_{(i)}, H\right\}
      = \delta^{(j)}_{(i)} \delta^{\mu}_{\nu}
          \frac{\partial H}{\partial P_{\nu(j)}}
      = \frac{\partial H}{\partial P_{\mu(i)}}
      \quad \Rightarrow \quad
      \dot{\bm{Q}_i} &=  \frac{\partial H}{\partial \bm{P}_i}
      \\
      \left\{ P_{\mu(i)}, H\right\}
      = - \delta^{(j)}_{(i)} \delta^{\nu}_{\mu}
          \frac{\partial H}{\partial Q^{\nu}_{(j)}}
      = - \frac{\partial H}{\partial Q^{\mu}_{(i)}}
      \quad \Rightarrow \quad
      \dot{\bm{P}_i} &= -\frac{\partial H}{\partial \bm{Q}_i}
    \end{align*}
\end{enumerate}

The Lagrangian equation of motion can be obtain by combining the evolution of
canonical variables and by substituting
definitions~\eqref{eq:def_canonical_coordinates} and~\eqref{eq:Ham_in_q}. Two
equations follows:

\begin{equation} \label{eq:ham_to_lagr_1}
  \frac{d}{dt}\left(\frac{\delta L}{\delta \bm{q}^{(i)}}\right) = -
  \frac{\delta L}{\delta \bm{q}^{(i-1)}} +
  \frac{\partial L}{\partial \bm{q}^{(i-1)}}
  \qquad i = 2, 3, \ldots, n
\end{equation}

\begin{equation} \label{eq:ham_to_lagr_2}
  \frac{d}{dt}\left(\frac{\delta L}{\delta \bm{q}^{(1)}}\right) = -
  \frac{\partial L}{\partial \bm{q}^{(0)}}
\end{equation}

Both equations simplify by using~\eqref{eq:functional_derivative_identity} and
while in the first one all terms cancel out, in the second one remains
$\frac{\delta L}{\delta \bm{q}^{(0)}} = 0$, indeed the Euler-Lagrange equation
of motion. \\



An advantage of the Hamiltonian formalism is the wider choice of coordinates
transformations. Unlike Lagrangian formalism, in the Hamiltonian description new
coordinates can be define starting from the old one by mixing the corresponding
generalized coordinates and their conjugate momenta such that \emph{canonical
commutation relations} are preserved.

\begin{equation} \label{eq:canonical_transformation}
  \begin{cases}
    \{\tilde{Q}^{\mu}_{(i)}, \tilde{Q}^{\nu}_{(j)}\} =
    \{Q^{\mu}_{(i)}, Q^{\nu}_{(j)}\} = 0 \\
    \{\tilde{P}_{\mu(i)}, \tilde{P}_{\nu(j)}\} =
    \{P_{\mu(i)}, P_{\nu(j)}\} = 0 \\
    \{\tilde{Q}^{\mu}_{(i)}, \tilde{P}_{\nu(j)}\} =
    \{Q^{\mu}_{(i)}, P_{\nu(j)}\} = \delta^{\mu}_{\nu} \delta_{ij}\\
  \end{cases}
  \quad \Rightarrow \quad
  \begin{cases}
    \tilde{\bm{Q}_i} = \tilde{\bm{Q}_i}(\bm{Q}_j, \bm{P}_j) \\
    \tilde{\bm{P}_i} = \tilde{\bm{P}_i}(\bm{Q}_j, \bm{P}_j)
  \end{cases}
\end{equation}

These transformation are called \emph{canonical transformation}.\\

Even though definition~\eqref{eq:def_canonical_coordinates} turns out to be a
wise choice it is not obvious where it came from. Using a third order
Lagrangian as example we try to give a
\paragraph{Motivation about the definition of canonical variables}
Consider the generic third order one-dimensional ($\mu=1$) Lagrangian
\begin{equation*}
  L\left( q, \dot{q}, \ddot{q}, q^{(3)} \right)
\end{equation*}
and the corresponding Euler-Lagrange equations
\begin{equation} \label{eq:third_order_euler_lagrangian}
  \frac{\partial L}{\partial q} -
  \frac{d}{dt}\frac{\partial L}{\partial \dot{q}} +
  \frac{d^2}{dt^2}\frac{\partial L}{\partial \ddot{q}} -
  \frac{d^3}{dt^3}\frac{\partial L}{\partial q^{(3)}} +
  \underbrace{
  \frac{d^4}{dt^4}\frac{\partial L}{\partial q^{(4)}} - \ldots }_0 = 0
\end{equation}

Collecting time derivatives, equation~\eqref{eq:third_order_euler_lagrangian}
can be written as
\begin{equation} \label{eq:third_order_euler_lagrangian_with_parts}
  \frac{\partial L}{\partial q} -
  \frac{d}{dt} \left(
  \frac{\partial L}{\partial \dot{q}} -
  \frac{d}{dt} \left(
  \frac{\partial L}{\partial \ddot{q}} -
  \frac{d}{dt} \left(
  \frac{\partial L}{\partial q^{(3)}}
  \right)\right)\right) = 0
\end{equation}

In the above equation appear generalized coordinates with derivation up to sixth
order (i.e. $q^{(6)}$). In order to translating Lagrangian formalism in the
Hamiltonian one, we need a map from generalized coordinates to canonical
variables~\footnote{
  There is no need to map $q^{(6)}$ because it appears
  in~\eqref{eq:third_order_euler_lagrangian} as a simple derivation of terms
  depending on $q^{(5)}$. When the expression for $q^{(5)}$ in terms of
  canonical variables is known, $q^{(6)}$ is also known.
}:
\begin{equation*}
  q^{(i)} \quad i = 0, 1, 2, 3, 4, 5
  \quad \longrightarrow \quad
  (P_i , Q_i) \quad i = 1, 2, 3
\end{equation*}

First we map $q$, $\dot{q}$, $\ddot{q}$ into canonical variables $Q_1$, $Q_2$,
$Q_3$
\begin{equation}\label{eq:def_Q}
  \begin{cases}
    Q_1 := q \\
    Q_2 := \dot{q} \\
    Q_3 := \ddot{q} \\
  \end{cases}
\end{equation}

Then we need to map $q^{(3)}$, $q^{(4)}$, $q^{(5)}$ into another set of
canonical variables and to do so we use the conjugate momenta $P_1$, $P_2$,
$P_3$. By looking at~\eqref{eq:third_order_euler_lagrangian_with_parts} we can
observe the following:
\begin{equation} \label{eq:third_order_euler_lagrangian_with_parts}
  \frac{\partial L}{\partial q} -
  \frac{d}{dt} \biggl(
  \underbrace{
  \frac{\partial L}{\partial \dot{q}} -
  \frac{d}{dt} \biggl(
  \underbrace{
  \frac{\partial L}{\partial \ddot{q}} -
  \frac{d}{dt} \biggl(
  \overbrace{
  \frac{\partial L}{\partial q^{(3)}}
  }^{\text{depends on } q^{(3)}} \biggr)
  }_{\text{depends on } q^{(4)}} \biggr)
  }_{\text{depends on } q^{(5)}} \biggr)
  = 0
\end{equation}

So it is convenient to define
\begin{equation}\label{eq:def_P}
  \begin{cases}
    P_3 := \text{part that depends on } q^{(3)}
         = \frac{\partial L}{\partial q^{(3)}} \\
    P_2 := \text{part that depends on } q^{(4)}
         = \frac{\partial L}{\partial \ddot{q}} -
           \frac{d}{dt} \left(
             \frac{\partial L}{\partial q^{(3)}}
           \right) \\
    P_1 := \text{part that depends on } q^{(5)}
         = \frac{\partial L}{\partial \dot{q}} -
           \frac{d}{dt} \left(
             \frac{\partial L}{\partial \ddot{q}} -
             \frac{d}{dt} \left(
               \frac{\partial L}{\partial q^{(3)}}
              \right)
            \right) \\
  \end{cases}
\end{equation}

Definitions in~\eqref{eq:def_P} can be rewritten in a more compact notation
employing the variational derivative~\eqref{eq:functional_derivative_y_i}.
Combining~\eqref{eq:def_Q} with~\eqref{eq:def_P} and generalizing to the
multidimensional case ($\mu > 1$) we obtain the
definition~\eqref{eq:def_canonical_coordinates} of canonical coordinates.
